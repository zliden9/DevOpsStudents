# DevOpsStudents
-Netology
-HelloNetology
-
---
Домашнее задание к занятию "4.1. Командная оболочка Bash: Практические навыки"
---
- 1) Обязательная задача 1
Есть скрипт:

a=1
b=2
c=a+b
d=$a+$b
e=$(($a+$b))
Какие значения переменным c,d,e будут присвоены? Почему?

Переменная	Значение	Обоснование
a	???	???
b	???	???
c	???	???

```
vagrant@vagrant:~$ a=1
vagrant@vagrant:~$ b=2
vagrant@vagrant:~$ c=a+b
vagrant@vagrant:~$ echo $c
a+b
#По умолчанию bash воспринемает все значения как строку
vagrant@vagrant:~$ d=$a+$b
vagrant@vagrant:~$ echo $d
1+2
#Аналогичная ситуация, переменны были объявлены с их значениями но небыло инициализации выражения для int значений
vagrant@vagrant:~$ e=$(($a+$b))
vagrant@vagrant:~$ echo $e
3
#Теперь мы объявили глобальную переменную с экранированием $((_)) по которому bash понимает что мы хотим выполнить арефметичесское вырожение

```
- 2) Обязательная задача 2
На нашем локальном сервере упал сервис и мы написали скрипт, который постоянно проверяет его доступность, записывая дату проверок до тех пор, пока сервис не станет доступным. В скрипте допущена ошибка, из-за которой выполнение не может завершиться, при этом место на Жёстком Диске постоянно уменьшается. Что необходимо сделать, чтобы его исправить:

while ((1==1)
do
	curl https://localhost:4757
	if (($? != 0))
	then
		date >> curl.log
	fi
done
Необходимо написать скрипт, который проверяет доступность трёх IP: 192.168.0.1, 173.194.222.113, 87.250.250.242 по 80 порту и записывает результат в файл log. 
Проверять доступность необходимо пять раз для каждого узла.

Ваш скрипт:
???
```
По какойто причине в моей оболочке bash при объявлении массивов возникала ошибка "script.sh: 1: Syntax error: "(" unexpected"
Поэтому проверить работоспособность полноценно не получилось, в нужных местах объявлял host=87.250.250.24 и использовал как обычную не массив переменную.
Для запуска скриптов с массивами писал bash --posix script.sh, скрипты вроде отработали как должны.
```
```
В объявленном цикле не хватает `)`
Также можно добавить оператор ожидания sleep
При успешном выполнении нужно перейти к проверке следущего адреса, для этого вводим оператор break,
но для непрерывной проверки можно не добавлять
```
```
#!/usr/bin/env bash
host=(192.168.0.1 173.194.222.113 87.250.250.24)
sleep 2
for i in {1..5}
do
date >>curl.log
    for b in ${host[@]}
    do
        curl -Is $b:80 >/dev/null
        echo "$b $? >>curl.log
    done
done
```
- 3) Обязательная задача 3
Необходимо дописать скрипт из предыдущего задания так, чтобы он выполнялся до тех пор, пока один из узлов не окажется недоступным. 
Если любой из узлов недоступен - IP этого узла пишется в файл error, скрипт прерывается.

Ваш скрипт:
???
```
#!/usr/bin/env bash
host=(192.168.0.1 173.194.222.113 87.250.250.24)
up=0
sleep 2

while (($up == 0))
do
    for b in ${host[@]}
    do
	curl -Is $b:80 >/dev/null
	up=$?
	if (($up != 0))
	then
	    echo $b >>error.log
	fi
    done
done
```
